<?xml version="1.0"?>
<launch>
  <arg name="ns" default="robot1"/>
  <arg name="format" default="xacro" doc="xacro ; urdf"/>
  <arg name="robot_type" value="$(env ROBOT_TYPE)" doc="robot_type [X1,X3,X3plus,R2,X7]"/>
  <arg name="world_name" default="track_empty" />
  <arg name="gui" default="true" />
  <arg name="run_camera" default="false"/>

    <arg name="x_pos" default="0.0"/>
    <arg name="y_pos" default="0.0"/>
    <arg name="z_pos" default="0.0"/>
    
    
  <include file="$(find gazebo_ros)/launch/empty_world.launch">
    <arg name="world_name" value="$(find yahboomcar_gazebo)/worlds/$(arg world_name).world"/>
    <arg name="gui" value="$(arg gui)"/>
  </include>

  <!-- urdf xml robot description loaded on the Parameter Server, converting the xacro into a proper urdf file-->
  <param name="robot_description" command="$(find xacro)/xacro --inorder
        '$(find yahboomcar_description)/urdf/yahboomcar_$(arg robot_type).urdf' " unless="$(eval arg('format') == 'xacro')"/>
  <param name="robot_description" command="$(find xacro)/xacro --inorder
        '$(find yahboomcar_description)/urdf/yahboomcar_$(arg robot_type).urdf.xacro' ns:=$(arg ns)" if="$(eval arg('format') == 'xacro')"/>
  <!-- push robot_description to factory and spawn robot in gazebo -->
  <node name="yahboomcar_spawn" pkg="gazebo_ros" type="spawn_model" output="screen" args="-urdf -param robot_description -model yahboomcar_$(arg robot_type) -x $(arg x_pos) -y $(arg y_pos) -z $(arg z_pos)" />
  
  <!-- TF setting############0715 -->
  <!--include file="$(find art_racecar)/launch/includes/art_car_tf.launch.xml" /-->
    <node name="joint_state_publisher" pkg="joint_state_publisher_gui" type="joint_state_publisher_gui"
            if="$(arg gui)"/>
    <node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher"
            unless="$(arg gui)"/>
    <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher"/>
  <!-- ros_control racecar launch file -->
  <!--include file="$(find yahboomcar_ctrl)/launch/yahboom_keyboard.launch" ns="/"/-->
  <include file="$(find x3plus_moveit_config)/launch/ros_controllers.launch"/>
  <!--include file="$(find yahboomcar_gazebo)/launch/yahboomcar_control.launch" ns="/"/-->
  <!-- Spawn the MUXs -->
  <arg name="yahboomcar_version" default="yahboomcar-v2" />
  <!--include file="$(find racecar)/launch/mux.launch" ns="vesc" /-->

  <!-- Publish "better odom" topic that is normally generated by the particle filter -->
  <!--node name="better_odom" pkg="topic_tools" type="relay"
          args="/vesc/odom /pf/pose/odom" /-->
    
  <!--Launch the simulation joystick control-->
  <rosparam command="load" file="$(find yahboomcar_gazebo)/config/keyboard_teleop.yaml" />
  <!--node pkg="yahboomcar_gazebo" type="keyboard_teleop.py" name="keyboard_teleop" /-->
</launch>
